# language: uk
Функціонал: Валідація логіки даних
  Як система
  Я хочу відхиляти фізично неможливі дані
  Щоб забезпечити цілісність генеалогічної інформації

  Передумова:
    Припустимо система валідаторів ініціалізована

  # ==================== Темпоральні Парадокси ====================

  @critical @T1
  Сценарій: Бенджамін Баттон - смерть раніше народження
    Коли я створюю особу з датою народження "1990" та датою смерті "1980"
    Тоді система відхиляє запит з кодом "T1_DEATH_BEFORE_BIRTH"
    І повідомлення містить "раніше народження"

  @critical @T2
  Сценарій: Батько з майбутнього
    Припустимо існує дитина народжена у "1990"
    Коли я додаю батька народженого у "2000"
    Тоді система відхиляє запит з кодом "T2_PARENT_YOUNGER"

  @critical @T3
  Сценарій: Мати-привид
    Припустимо існує мати яка померла у "1990"
    Коли я додаю дитину народжену у "1995"
    Тоді система відхиляє запит з кодом "T3_MOTHER_GHOST"

  @high @T4
  Сценарій: Батько-привид (warning)
    Припустимо існує батько який помер у "1990"
    Коли я додаю дитину народжену у "1995"
    Тоді система видає попередження "T4_FATHER_GHOST"
    Але операція дозволена

  @critical @T5
  Сценарій: Шлюб у дитсадку
    Коли я створюю шлюб для особи народженої у "1990" з датою шлюбу "1995"
    Тоді система відхиляє запит з кодом "T5_CHILD_MARRIAGE"
    І вік на момент шлюбу був "5 років"

  @critical @T6
  Сценарій: Розлучення до весілля
    Коли я створюю шлюб з датою весілля "2000" та розлучення "1995"
    Тоді система відхиляє запит з кодом "T6_DIVORCE_BEFORE_MARRIAGE"

  # ==================== TimeResolver ====================

  @high @time-resolver
  Структура сценарію: Гнучкий парсинг дат
    Коли я ввожу дату "<input>"
    Тоді TimeResolver повертає рік <expected_year>
    І точність "<confidence>"

    Приклади:
      | input      | expected_year | confidence  |
      | 1990       | 1990          | exact       |
      | ~1900      | 1900          | approximate |
      | c. 1900    | 1900          | approximate |
      | 1910..1920 | 1915          | range       |
      | ?          | None          | unknown     |
      | невідомо   | None          | unknown     |

  @high @time-resolver
  Сценарій: Пропуск валідації при невідомих датах
    Коли я створюю особу з датою народження "?" та датою смерті "1990"
    Тоді валідація пропущена
    І особа успішно створена

  # ==================== Топологічні Парадокси ====================

  @critical @C1
  Сценарій: Нарцисизм - шлюб сам на собі
    Коли я намагаюсь створити шлюб особи з ID "person_1" та "person_1"
    Тоді система відхиляє запит з кодом "C1_SELF_MARRIAGE"

  @critical @C2
  Сценарій: Циклічний батько
    Припустимо існує ланцюг: A -> B -> C (батько -> син -> онук)
    Коли я намагаюсь зробити C батьком A
    Тоді система відхиляє запит з кодом "C3_CYCLE_DETECTED"

  # ==================== Біологічні Обмеження ====================

  @high @B1
  Сценарій: Занадто молодий батько
    Коли батько народився у "1990" а дитина у "1995"
    Тоді система відхиляє запит з кодом "B1_PARENT_TOO_YOUNG"
    І вік батька при народженні був "5 років"

  @medium @B2
  Сценарій: Занадто стара мати (warning)
    Коли мати народилась у "1920" а дитина у "2000"
    Тоді система видає попередження "B2_MOTHER_TOO_OLD"
    Але операція дозволена

  @critical @B4
  Сценарій: Три біологічних батьки
    Припустимо особа вже має двох біологічних батьків
    Коли я намагаюсь додати третього біологічного батька
    Тоді система відхиляє запит з кодом "B4_THREE_PARENTS"

  # ==================== Полігамія ====================

  @critical @M1
  Сценарій: Гарем (активна полігамія)
    Припустимо особа має активний шлюб (статус "married")
    Коли я намагаюсь додати другий активний шлюб
    Тоді система відхиляє запит з кодом "M1_POLYGAMY"

